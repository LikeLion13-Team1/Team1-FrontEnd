<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>로그인 후 화면</title>
    <link rel="stylesheet" href="../styles/global.css" />
    <link rel="stylesheet" href="../styles/header.css" />
    <link rel="stylesheet" href="../styles/sidebar.css" />
    <link rel="stylesheet" href="../styles/Q.css" />
    <link rel="stylesheet" href="../styles/home2.css" />
    <link rel="stylesheet" href="../styles/home1.css" />
  </head>
  <body class="home2-page">
    <header class="main-header">
      <div id="header"></div>
    </header>
    <div class="main">
      <aside class="aside">
        <div id="sidebar"></div>
      </aside>
      <section class="content">
        <h1 class="welcome">멋사님, 오늘도 좋은 하루 보내세요 :)</h1>
        <hr class="divider" />
        <div class="bot-box">
          <img src="../assets/bot.png" class="bot-icon" />
          <p class="role-text">
            오늘 하루는 무엇부터 하면 좋을까요?<br />
            살리미라면 답을 알고 있을지도 몰라요!
          </p>
        </div>

        <!-- 카드 영역 -->
        <div class="card-container">
          <div class="info-card card1">
            <div class="title">
              <p class="card-title">나만의 루틴 추천</p>
              <img src="../assets/check.png" class="check" />
            </div>
            <div class="card-desc">
              나의 루틴 성격
              <ul class="type-list">
                <li>느긋한 루틴 스타일</li>
                <li>정리보단 유지가 중요</li>
                <li>저녁에 집중</li>
              </ul>
              필요할 땐 [나만의 루틴 찾기]에서<br />
              다시 추천받을 수 있어요!
            </div>
          </div>

          <div class="info-card card2">
            <div class="title">
              <p class="card-title">살리미 챗봇</p>
              <img src="../assets/robot.png" class="check" />
            </div>
            <div class="card-desc">
              살리미가 추천하는 오늘의 질문
              <ul class="type-list2">
                <li>“오늘 날씨 알려줘”</li>
                <li>“오늘 어떤 루틴 하면 좋을까?”</li>
                <li>“10분 안에 끝나는 살림 알려줘”</li>
              </ul>
              살리미는 [챗봇]에서<br />
              만날 수 있어요! <br />
            </div>
          </div>

          <div class="info-card card3">
            <div class="title">
              <p class="card-title">내 캘린더</p>
              <img src="../assets/calender.png" class="check" />
            </div>
            <div class="card-desc">
              오늘의 루틴
              <ul class="type-list">
                <li>오전: 세탁물 정리</li>
                <li>오후: 분리수거</li>
                <li>저녁: 설거지</li>
              </ul>
              이번 주 달성률: 3 / 7<br />
              (일요일까지 4개 남았어요!)
            </div>
          </div>
        </div>
      </section>
    </div>
    <script type="module">
      import { loadSidebar } from "../js/loadSidebar.js";
      loadSidebar();
    </script>
    <script type="module">
      import { loadHeader } from "../js/loadHeader.js";
      loadHeader();
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const token = sessionStorage.getItem("token");
        const welcomeEl = document.querySelector(".welcome");

        if (!token || !welcomeEl) return;

        try {
          const response = await fetch(
            "http://13.209.221.182:8080/api/v1/members/info",
            {
              method: "GET",
              headers: {
                Authorization: `Bearer ${token}`,
              },
            }
          );
          const data = await response.json();
          console.log("사용자 정보 응답:", data);
          if (data.isSuccess && data.result?.username) {
            const userName = data.result.username;
            welcomeEl.innerHTML = `${userName}님, 오늘도 좋은 하루 보내세요 :)`;
          } else {
            welcomeEl.innerHTML = `멋사님, 오늘도 좋은 하루 보내세요 :)`;
          }
        } catch (err) {
          console.error("사용자 정보 요청 실패:", err);
          welcomeEl.innerHTML = `멋사님, 오늘도 좋은 하루 보내세요 :)`;
        }
      });
    </script>
  </body>
</html>
